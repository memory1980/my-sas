import os
import time
import pandas as pd
import baostock as bs
from typing import List
from datetime import datetime
from GTD import get_trade_date


from SKL import get_skline_data

from FKL import get_fkline_data

from index_codes import  index_codes

codes=index_codes[:]




print(f"æ€»å…± {len(codes[:])} åªè‚¡ç¥¨...")

# ç™»å½•baostock
lg = bs.login()
if lg.error_code != '0':
    print(f"ç™»å½•å¤±è´¥: {lg.error_msg}")
    exit()




# è·å–æ—¥çº¿æ•°æ®
print("\n" + "="*70)
print("ğŸ“ˆ è·å–æœˆçº¿æ•°æ®")
print("="*70)
daily_data = get_fkline_data(
    days=600,  # çº¦7å¹´æ•°æ®
    codes=codes,
    frequency='m',
    delay=0.00000,
    save_to_csv=True,
    save_folder=r"d:\my-sas\data"
)


    # è·å–æ—¥çº¿æ•°æ®
print("\n" + "="*70)
print("ğŸ“ˆ è·å–å‘¨çº¿æ•°æ®")
print("="*70)
daily_data = get_fkline_data(
    days=400,  # çº¦7å¹´æ•°æ®
    codes=codes,
    frequency='w',
    delay=0.00000,
    save_to_csv=True,
    save_folder=r"d:\my-sas\data"
)



# è·å–æ—¥çº¿æ•°æ®
print("\n" + "="*70)
print("ğŸ“ˆ è·å–æ—¥çº¿æ•°æ®")
print("-"*50)
daily_data = get_fkline_data(
    days=600,  # çº¦7å¹´æ•°æ®
    codes=codes,
    frequency='d',
    delay=0.00000,
    save_to_csv=True,
    save_folder=r"d:\my-sas\data"
)

print(daily_data)

# é€€å‡ºç™»å½•
bs.logout()
print("\nâœ… æ‰€æœ‰æ•°æ®è·å–å®Œæˆï¼")